import{s as q,h as C,i as n,t as h,z as N,j as I,A as R,u as A,c as f,l as o,b as c,F as E,d as F,e as O,B as V,x as j,ab as w,o as v,G as L,ar as M,ac as S,m as z}from"./OmrnE3d5.js";const G={class:"portfolio__area pt-40 pb-40"},H={key:0,class:"container"},U={class:"row"},J={class:"col-lg-12"},K={class:"row"},Q={class:"col-xl-12"},T={class:"blog__list-item-wrapper"},W={class:"col-xxl-12"},X={class:"tp-pagination mt-30"},Z={__name:"index-grid",props:{props_item:{type:Object,required:!0}},async setup(P){let e,i;const d=q(),b=C(),p=z(),_=n([]),x=n(12),s=n(1),u=n(1),m=n(0),t=n({department_id:null,service_category_id:null,title:"",created_year:null,created_month:null,is_publish:1,text_all:""}),B=P,g=n({news_types:[],perPage:[{title:"20",value:20},{title:"40",value:40},{title:"60",value:60}],service_categories:[],departments:[]}),{data:D}=([e,i]=h(async()=>w("Department",async()=>await $fetch(`${p.public.apiBase}/department`,{params:{is_publish:1}}))),e=await e,i(),e);g.value.departments=D.value.data.map(a=>({title:a.name_th,value:a.id}));const{data:$}=([e,i]=h(async()=>w("ServiceCategory",async()=>await $fetch(`${p.public.apiBase}/service-category`,{params:{is_publish:1}}))),e=await e,i(),e);g.value.service_categories=$.value.data.map(a=>({title:a.name_th,value:a.id})),d.query.service_category_id!=null&&(t.value.service_category_id=g.value.service_categories.find(a=>a.value==d.query.service_category_id)),d.query.page&&(s.value=d.query.page);const{data:y}=([e,i]=h(async()=>w("serve",async()=>{let a={...t.value,service_category_id:t.value.service_category_id==null?void 0:t.value.service_category_id.value,department_id:t.value.department_id==null?void 0:t.value.department_id.value,created_year:t.value.created_year==null?void 0:t.value.created_year.value,created_month:t.value.created_month==null?void 0:t.value.created_month.value,perPage:x.value,currentPage:s.value,department_id:B.props_item.department_id},l=await $fetch(`${p.public.apiBase}/serve`,{params:a});return _.value=l.data,u.value=l.totalPage,m.value=l.totalData,l})),e=await e,i(),e);return _.value=y.value.data,u.value=y.value.totalPage,m.value=y.value.totalData,N([s,t.value],()=>{console.log("FREDOM"),b.replace({name:"serve",query:{page:s.value}}),S("serve")},{deep:!0}),I(()=>{}),R(()=>{s.value>u.value&&(s.value=u.value)}),A({title:"งานบริการวิชาการ"}),(a,l)=>(v(),f("section",G,[o(_).length!=0?(v(),f("div",H,[c("div",U,[c("div",J,[c("div",K,[c("div",Q,[c("div",T,[(v(!0),f(E,null,F(o(_),(r,k)=>(v(),L(M,{key:k,item:{link:"/serve/",id:r.id,title:r.title,file:r.serve_file,created:r.created_serve,type_name:r.service_category.name_th,dep_name:r.department.name_th}},null,8,["item"]))),128))])]),c("div",W,[c("div",X,[O(V,{totalPage:o(u),currentPage:o(s),totalItems:o(m),"onUpdate:currentPage":l[0]||(l[0]=r=>s.value=r)},null,8,["totalPage","currentPage","totalItems"])])])])])])])):j("",!0)]))}};export{Z as default};
