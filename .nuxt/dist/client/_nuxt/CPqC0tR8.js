import{f as F,g as R,h as z,s as N,i as b,t as B,j as T,c as j,b as t,e as i,w as u,l as a,k as D,v as M,F as O,m as S,y as g,p as A,r as L,o as Q,q as Z,C as y}from"./OmrnE3d5.js";import{_ as G}from"./B-r68-ay.js";import{u as H}from"./D-HlV6Uy.js";import{u as w}from"./I6A_oj8C.js";import{b as I}from"./BKZYPkvF.js";import{f as p}from"./C0vxPmJo.js";const J={class:"breadcrumb__area include-bg pb-40 pt-30 grey-bg-4"},K={class:"container"},P={class:"row"},W={class:"col-xxl-12"},X={class:"breadcrumb__content p-relative z-index-1"},Y={class:"breadcrumb__list"},tt=t("span",null," จัดการข้อมูล ",-1),et=t("span",{class:"dvdr"},[t("i",{class:"fa-solid fa-circle-small"})],-1),lt=t("span",{class:"dvdr"},[t("i",{class:"fa-solid fa-circle-small"})],-1),at=t("span",null," แก้ไขข้อมูล ",-1),st={class:"portfolio__area pt-40 pb-40"},ot={class:"container"},it={class:"row"},nt=t("div",{class:"col-12"},[t("h4",null,"แบบฟอร์มแก้ไขข้อมูล")],-1),rt={class:"col-12"},ct={class:""},dt={class:""},ut={class:"form-group row mt-10"},_t=t("label",{for:"",class:"label label-required"},"หน่วยงาน : ",-1),ht={class:"form-group row mt-10"},mt=t("label",{for:"",class:"label label-required"},"ประเภทการบริการวิชาการ : ",-1),vt={class:"form-group row mt-10"},pt=t("label",{for:"",class:"label label-required"},"รูปภาพปก : ",-1),ft={class:"col-sm-10"},bt={class:"col-sm-2"},gt=["href"],yt={class:"form-group row mt-10"},Vt=t("label",{for:"",class:"label label-required"},"หัวข้อ : ",-1),wt={class:"form-group row mt-10"},xt=t("label",{for:"",class:"label label-required"},"รายละเอียด : ",-1),kt=t("div",{id:"detail-th"},null,-1),Et={class:"form-group row mt-10"},qt=t("label",{for:"",class:"label label-required"},"อัตราค่าใช้บริการ : ",-1),Ct=t("div",{id:"detail-th"},null,-1),$t={class:"form-group row mt-10"},Ut=t("label",{for:"",class:"label label-required"},"สถานที่ : ",-1),Ft=t("div",{id:"detail-th"},null,-1),Rt={class:"form-group row mt-10"},zt=t("label",{for:"",class:"label label-required"},"ข้อมูลติดต่อ : ",-1),Nt=t("div",{id:"detail-th"},null,-1),Bt={class:"form-group row mt-10"},Tt=t("label",{for:"",class:"label label-required"},"สถานะ : ",-1),Qt={__name:"[id]",async setup(jt){let m,V;F.extend(R);const x=S(),{apiBase:v}=x.public,k=z(),E=N(),e=b({title_th:null,title_en:null,detail_th:"",detail_en:"",department_id:null,service_category_id:null,is_publish:{id:1,value:1,name_th:"publish",name_en:"publish",color:"success"},rates_th:"",rates_en:"",location_th:"",location_en:"",contact_th:"",contact_en:""}),f=b(null),h=b({publishes:I.data().publishes,departments:[],service_categories:[]});(Math.random()+1).toString(36).substring(7);let n={};const q=()=>{n.detail_th=p.data().froala_config(),n.detail_th.events={keyup:function(s){e.value.detail_th=this.html.get()},click:function(s){e.value.detail_th=this.html.get()},"commands.after":function(s,l,c){e.value.detail_th=this.html.get()},"paste.after":function(s){e.value.detail_th=this.html.get()},initialized:function(){this.html.insert(e.value.detail_th)}},n.rates_th=p.data().froala_config(),n.rates_th.events={keyup:function(s){e.value.rates_th=this.html.get()},click:function(s){e.value.rates_th=this.html.get()},"commands.after":function(s,l,c){e.value.rates_th=this.html.get()},"paste.after":function(s){e.value.rates_th=this.html.get()},initialized:function(){this.html.insert(e.value.rates_th)}},n.location_th=p.data().froala_config(),n.location_th.events={keyup:function(s){e.value.location_th=this.html.get()},click:function(s){e.value.location_th=this.html.get()},"commands.after":function(s,l,c){e.value.location_th=this.html.get()},"paste.after":function(s){e.value.location_th=this.html.get()},initialized:function(){this.html.insert(e.value.location_th)}},n.contact_th=p.data().froala_config(),n.contact_th.events={keyup:function(s){e.value.contact_th=this.html.get()},click:function(s){e.value.contact_th=this.html.get()},"commands.after":function(s,l,c){e.value.contact_th=this.html.get()},"paste.after":function(s){e.value.contact_th=this.html.get()},initialized:function(){this.html.insert(e.value.contact_th)}}},C=async()=>{let s=await $fetch(`${v}/department`,{params:{is_publish:1}}).catch(l=>l.data);h.value.departments=s.data.map(l=>({title:l.name_th,value:l.id})).filter(l=>g("user").value&&g("user").value.group_id==2?l.value==g("user").value.department_id:!0)},$=async()=>{let s=await $fetch(`${v}/service-category`,{params:{is_publish:1}}).catch(l=>l.data);h.value.service_categories=s.data.map(l=>({title:l.name_th,value:l.id}))},{data:_}=([m,V]=B(()=>H(`${v}/serve/${E.params.id}`,{server:!0},"$eqZsQE3faT")),m=await m,V(),m);e.value={..._.value.data},e.value.serve_file_old=_.value.data.serve_file,e.value.department_id={title:_.value.data.department.name,value:_.value.data.department_id},e.value.service_category_id={title:_.value.data.service_category.name_th,value:_.value.data.service_category_id},e.value.is_publish=h.value.publishes[Number(_.value.data.is_publish)];const U=async()=>{if(console.log(),e.value.is_publish==null||e.value.is_publish.value==null||e.value.service_category_id==null||e.value.title_th==""||e.value.title_th==null||e.value.detail_th==""||e.value.detail_th==null){w("โปรดระบุข้อมูลให้ครบถ้วน","error");return}let s={text_success:"แก้ไขรายการเสร็จสิ้น",method:"put",url:v+"/serve/"+e.value.id},l={...e.value,serve_file:f.value.files!=null?f.value.files[0]:null,is_publish:e.value.is_publish.value,department_id:e.value.department_id==null?void 0:e.value.department_id.value,service_category_id:e.value.service_category_id==null?void 0:e.value.service_category_id.value};var c=new FormData;for(var r in l)c.append(r,l[r]);await $fetch(s.url,{method:s.method,body:c}).then(d=>{if(d.msg=="success")w(s.text_success,"success"),k.push({path:"/admin/serve/"});else throw new Error("ERROR")}).catch(d=>d.data)};return T(()=>{C(),$(),q()}),(s,l)=>{const c=A,r=G,d=L("froala");return Q(),j(O,null,[t("section",J,[t("div",K,[t("div",P,[t("div",W,[t("div",X,[t("div",Y,[tt,et,t("span",null,[i(c,{href:"/admin/serve"},{default:u(()=>[Z(" รายการงานบริการวิชาการ ")]),_:1})]),lt,at])])])])])]),t("section",st,[t("div",ot,[t("div",it,[nt,t("div",rt,[t("div",ct,[t("div",dt,[t("div",ut,[_t,t("div",null,[i(r,null,{default:u(()=>[i(a(y),{label:"title",placeholder:"หน่วยงาน",options:a(h).departments,modelValue:a(e).department_id,"onUpdate:modelValue":l[0]||(l[0]=o=>a(e).department_id=o),class:"v-select-no-border",clearable:!0},null,8,["options","modelValue"])]),_:1})])]),t("div",ht,[mt,t("div",null,[i(r,null,{default:u(()=>[i(a(y),{label:"title",placeholder:"ประเภทการบริการวิชาการ",options:a(h).service_categories,modelValue:a(e).service_category_id,"onUpdate:modelValue":l[1]||(l[1]=o=>a(e).service_category_id=o),class:"v-select-no-border",clearable:!0},null,8,["options","modelValue"])]),_:1})])]),t("div",vt,[pt,t("div",ft,[t("input",{ref_key:"file",ref:f,class:"form-control",type:"file",id:"formFile"},null,512)]),t("div",bt,[t("a",{href:a(e).serve_file_old,target:"_blank",class:"btn btn-primary",style:{width:"100%"}}," View Old File ",8,gt)])]),t("div",yt,[Vt,t("div",null,[D(t("input",{type:"text",class:"form-control form-control-plaintext","onUpdate:modelValue":l[2]||(l[2]=o=>a(e).title_th=o)},null,512),[[M,a(e).title_th]])])]),t("div",wt,[xt,t("div",null,[i(r,null,{default:u(()=>[i(d,{tag:"textarea",config:a(n).detail_th,modelValue:a(e).detail_th,"onUpdate:modelValue":l[3]||(l[3]=o=>a(e).detail_th=o)},null,8,["config","modelValue"]),kt]),_:1})])]),t("div",Et,[qt,t("div",null,[i(r,null,{default:u(()=>[i(d,{tag:"textarea",config:a(n).rates_th,modelValue:a(e).rates_th,"onUpdate:modelValue":l[4]||(l[4]=o=>a(e).rates_th=o)},null,8,["config","modelValue"]),Ct]),_:1})])]),t("div",$t,[Ut,t("div",null,[i(r,null,{default:u(()=>[i(d,{tag:"textarea",config:a(n).location_th,modelValue:a(e).location_th,"onUpdate:modelValue":l[5]||(l[5]=o=>a(e).location_th=o)},null,8,["config","modelValue"]),Ft]),_:1})])]),t("div",Rt,[zt,t("div",null,[i(r,null,{default:u(()=>[i(d,{tag:"textarea",config:a(n).contact_th,modelValue:a(e).contact_th,"onUpdate:modelValue":l[6]||(l[6]=o=>a(e).contact_th=o)},null,8,["config","modelValue"]),Nt]),_:1})])]),t("div",Bt,[Tt,t("div",null,[i(r,null,{default:u(()=>[i(a(y),{label:"name_th",placeholder:"การเผยแพร่",options:a(h).publishes,id:"slt-is_publish",modelValue:a(e).is_publish,"onUpdate:modelValue":l[7]||(l[7]=o=>a(e).is_publish=o),class:"v-select-no-border",clearable:!0},null,8,["options","modelValue"])]),_:1})])]),t("div",{class:"col-md-12 mt-20"},[t("div",{class:"contact__btn-2 text-center"},[t("button",{class:"btn btn-primary",onClick:U}," บันทึก ")])])])])])])])])],64)}}};export{Qt as default};
