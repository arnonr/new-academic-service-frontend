import{_ as M}from"./B-r68-ay.js";import{f as k,g as T,i as c,z as E,A as I,j as U,u as z,c as i,b as e,k as H,v as j,l as s,e as u,w as f,x as h,q as F,F as P,d as L,B as S,a as q,m as A,y as g,o as r,C as V,D as _,E as O,p as R}from"./OmrnE3d5.js";import{b as G}from"./BKZYPkvF.js";const J=q('<section class="breadcrumb__area include-bg pb-40 pt-30 grey-bg-4"><div class="container"><div class="row"><div class="col-xxl-12"><div class="breadcrumb__content p-relative z-index-1"><div class="breadcrumb__list"><span> จัดการข้อมูล </span><span class="dvdr"><i class="fa-solid fa-circle-small"></i></span><span> ข่าวประชาสัมพันธ์ </span></div></div></div></div></div></section>',1),K={class:"portfolio__area pt-40"},Q={class:"container"},W={class:"mt-10 mb-30 pl-10 pt-15 pb-10 bg-grey"},X=e("h4",{class:"section-bg-primary mb-20"},[e("i",{class:"fa-solid fa-search"}),e("span",{class:"ml-10"},"ค้นหา")],-1),Y={class:"row"},Z={class:"col-12 col-lg-4"},ee={key:0,class:"col-12 col-lg-4"},te={key:1,class:"col-12 col-lg-4"},se={class:"portfolio__area pt-40 pb-40"},ae={class:"container"},le={class:"mt-10 mb-30 pl-10 pt-15 pb-10 bg-grey"},ne=e("h4",{class:"section-bg-primary mb-20"},[e("i",{class:"fa-regular fa-news"}),e("span",{class:"ml-10"},"รายการข่าวประชาสัมพันธ์")],-1),oe={class:"mb-20"},ce=e("i",{class:"fa-regular fa-plus"},null,-1),ie={class:"row gx-2 grid"},re={class:"col-12"},de={class:"table-responsive"},ue={class:"table table-bordered table-striped table-admin"},_e=e("thead",null,[e("tr",null,[e("th",{class:"text-center"}),e("th",{class:"text-center"},"ชื่อ (TH)"),e("th",{class:"text-center"},"ประเภทข่าว"),e("th",{class:"text-center"},"หน่วยงาน"),e("th",{class:"text-center"}," วันที่ลงข่าว "),e("th",{class:"text-center"},"สถานะ"),e("th",{class:"text-center"},"จัดการ")])],-1),pe={key:0},me=["src"],he={class:"text-center"},be={class:"text-center",style:{"min-width":"8rem"}},ve=e("i",{class:"fa-regular fa-edit"},null,-1),fe=["href"],ge=e("i",{class:"fa-regular fa-eye"},null,-1),ye=[ge],we={class:"col-xxl-12"},xe={class:"tp-pagination mt-30"},Ce={__name:"index",setup(ke){k.extend(T);const $=A(),{apiBase:b}=$.public,v=c([]),C=c(20),d=c(1),p=c(1),y=c(0),l=c({}),n=c({perPage:[{title:"20",value:20},{title:"40",value:40},{title:"60",value:60}],publishes:G.data().publishes,news_types:[],departments:[]}),w=async()=>{let o=await $fetch(`${b}/department`,{params:{is_publish:1}}).catch(t=>t.data);n.value.departments=o.data.map(t=>({title:t.name_th,value:t.id})).filter(t=>g("user").value&&g("user").value.group_id==2?t.value==g("user").value.department_id:!0)},B=async()=>{let o=await $fetch(`${b}/news-type`,{params:{is_publish:1}}).catch(t=>t.data);n.value.news_types=o.data.map(t=>({title:t.name_th,value:t.id}))},x=async()=>{let o={...l.value,news_type_id:l.value.news_type_id==null?void 0:l.value.news_type_id.value,perPage:C.value,currentPage:d.value},t=await $fetch(`${b}/news`,{params:o}).catch(m=>m.data);v.value=t.data,p.value=t.totalPage,y.value=t.totalData};return E([d,l],()=>{x(),w()},{deep:!0}),I(()=>{d.value>p.value&&(d.value=p.value)}),U(()=>{w(),B(),x()}),z({title:"รายการข่าว"}),(o,t)=>{const m=M,D=R;return r(),i(P,null,[J,e("section",K,[e("div",Q,[e("div",W,[X,e("div",Y,[e("div",Z,[H(e("input",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=a=>s(l).title_th=a),name:"title_th",type:"text",placeholder:"หัวข้อข่าว (TH)"},null,512),[[j,s(l).title_th]])]),s(n).news_types.length!=0?(r(),i("div",ee,[u(m,null,{default:f(()=>[u(s(V),{label:"title",placeholder:"ประเภทข่าว",options:s(n).news_types,modelValue:s(l).news_type_id,"onUpdate:modelValue":t[1]||(t[1]=a=>s(l).news_type_id=a),class:"v-select-no-border",clearable:!0},null,8,["options","modelValue"])]),_:1})])):h("",!0),s(n).departments.length!=0?(r(),i("div",te,[u(m,null,{default:f(()=>[u(s(V),{label:"title",placeholder:"หน่วยงาน",options:s(n).departments,modelValue:s(l).department_id,"onUpdate:modelValue":t[2]||(t[2]=a=>s(l).department_id=a),class:"v-select-no-border",clearable:!0},null,8,["options","modelValue"])]),_:1})])):h("",!0)])])])]),e("section",se,[e("div",ae,[e("div",le,[ne,e("div",oe,[e("button",{type:"button",class:"btn btn-primary",onClick:t[3]||(t[3]=()=>{o.$router.push({path:"/admin/news/add"})})},[ce,F(" เพิ่มข้อมูล ")])]),e("div",ie,[e("div",re,[e("div",de,[e("table",ue,[_e,s(v).length!=0?(r(),i("tbody",pe,[(r(!0),i(P,null,L(s(v),(a,N)=>(r(),i("tr",{key:N},[e("td",null,[e("img",{src:a.news_file,alt:"",class:"img-thumbnail",style:{width:"100px"}},null,8,me)]),e("td",null,_(a.title_th),1),e("td",null,_(a.news_type.name),1),e("td",null,_(a.department.name_th),1),e("td",null,_(s(k)(a.created_news).locale("th").format("DD MMM BB")),1),e("th",he,[a.is_publish!=null?(r(),i("span",{key:0,class:O("badge rounded-pill bg-"+s(n).publishes[a.is_publish].color)},_(s(n).publishes[a.is_publish].name_th),3)):h("",!0)]),e("td",be,[u(D,{to:{name:"admin-news-id",params:{id:a.id}},class:"btn btn-warning text-uppercase"},{default:f(()=>[ve]),_:2},1032,["to"]),e("a",{href:`../news/${a.id}`,class:"btn btn-primary text-uppercase ml-10",target:"_blank"},ye,8,fe)])]))),128))])):h("",!0)])])])]),e("div",we,[e("div",xe,[u(S,{totalPage:s(p),currentPage:s(d),totalItems:s(y),"onUpdate:currentPage":t[4]||(t[4]=a=>d.value=a)},null,8,["totalPage","currentPage","totalItems"])])])])])])],64)}}};export{Ce as default};
