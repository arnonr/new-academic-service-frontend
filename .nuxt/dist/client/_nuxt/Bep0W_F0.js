import{f as g,g as q,h as C,i as p,j as U,u as R,c as $,b as t,e as i,w as u,k as z,v as D,l as a,F as M,m as B,y as f,p as F,r as N,o as Y,q as j,C as b}from"./OmrnE3d5.js";import{_ as S}from"./B-r68-ay.js";import{u as V}from"./I6A_oj8C.js";import{b as T}from"./BKZYPkvF.js";import{f as h}from"./C0vxPmJo.js";const O={class:"breadcrumb__area include-bg pb-40 pt-30 grey-bg-4"},H={class:"container"},L={class:"row"},A={class:"col-xxl-12"},G={class:"breadcrumb__content p-relative z-index-1"},I={class:"breadcrumb__list"},J=t("span",null," จัดการข้อมูล ",-1),K=t("span",{class:"dvdr"},[t("i",{class:"fa-solid fa-circle-small"})],-1),P=t("span",{class:"dvdr"},[t("i",{class:"fa-solid fa-circle-small"})],-1),Q=t("span",null," เพิ่มข้อมูล ",-1),W={class:"portfolio__area pt-40 pb-40"},X={class:"container"},Z={class:"row"},tt=t("div",{class:"col-12 mb-20"},[t("h4",null,"แบบฟอร์มเพิ่มข้อมูล")],-1),et={class:"col-12"},lt={class:""},at={class:""},st={class:"form-group row mt-10"},ot=t("label",{for:"",class:"label label-required"},"หน่วยงาน : ",-1),it={class:"form-group row mt-10"},nt=t("label",{for:"",class:"label label-required"},"ประเภทการบริการวิชาการ : ",-1),ct={class:"form-group row mt-10"},rt=t("label",{for:"",class:"label label-required"},"รูปภาพปก : ",-1),dt={class:"form-group row mt-10"},ut=t("label",{for:"",class:"label label-required"},"หัวข้อ : ",-1),_t={class:"form-group row mt-10"},ht=t("label",{for:"",class:"label label-required"},"รายละเอียด : ",-1),mt=t("div",{id:"detail-th"},null,-1),vt={class:"form-group row mt-10"},pt=t("label",{for:"",class:"label label-required"},"อัตราค่าใช้บริการ : ",-1),ft=t("div",{id:"detail-th"},null,-1),bt={class:"form-group row mt-10"},gt=t("label",{for:"",class:"label label-required"},"สถานที่ : ",-1),Vt=t("div",{id:"detail-th"},null,-1),yt={class:"form-group row mt-10"},xt=t("label",{for:"",class:"label label-required"},"ข้อมูลติดต่อ : ",-1),wt=t("div",{id:"detail-th"},null,-1),kt={class:"form-group row mt-10"},Et=t("label",{for:"",class:"label label-required"},"สถานะ : ",-1),Dt={__name:"add",setup(qt){g.extend(q);const y=B(),{apiBase:m}=y.public,x=C(),e=p({title_th:null,title_en:null,department_id:null,service_category_id:null,detail_th:"",detail_en:"",is_publish:{id:1,value:1,name_th:"publish",name_en:"publish",color:"success"},rates_th:"",rates_en:"",location_th:"",location_en:"",contact_th:"",contact_en:""}),v=p(null),_=p({publishes:T.data().publishes,departments:[],service_categories:[]});(Math.random()+1).toString(36).substring(7);let n={};n.detail_th=h.data().froala_config(),n.detail_th.events={keyup:function(s){e.value.detail_th=this.html.get()},click:function(s){e.value.detail_th=this.html.get()},"commands.after":function(s,l,r){e.value.detail_th=this.html.get()},"paste.after":function(s){e.value.detail_th=this.html.get()},initialized:function(){this.html.insert(e.value.detail_th)}},n.rates_th=h.data().froala_config(),n.rates_th.events={keyup:function(s){e.value.rates_th=this.html.get()},click:function(s){e.value.rates_th=this.html.get()},"commands.after":function(s,l,r){e.value.rates_th=this.html.get()},"paste.after":function(s){e.value.rates_th=this.html.get()},initialized:function(){this.html.insert(e.value.rates_th)}},n.location_th=h.data().froala_config(),n.location_th.events={keyup:function(s){e.value.location_th=this.html.get()},click:function(s){e.value.location_th=this.html.get()},"commands.after":function(s,l,r){e.value.location_th=this.html.get()},"paste.after":function(s){e.value.location_th=this.html.get()},initialized:function(){this.html.insert(e.value.location_th)}},n.contact_th=h.data().froala_config(),n.contact_th.events={keyup:function(s){e.value.contact_th=this.html.get()},click:function(s){e.value.contact_th=this.html.get()},"commands.after":function(s,l,r){e.value.contact_th=this.html.get()},"paste.after":function(s){e.value.contact_th=this.html.get()},initialized:function(){this.html.insert(e.value.contact_th)}};const w=async()=>{let s=await $fetch(`${m}/department`,{params:{is_publish:1}}).catch(l=>l.data);_.value.departments=s.data.map(l=>({title:l.name_th,value:l.id})).filter(l=>f("user").value&&f("user").value.group_id==2?l.value==f("user").value.department_id:!0)},k=async()=>{let s=await $fetch(`${m}/service-category`,{params:{is_publish:1}}).catch(l=>l.data);_.value.service_categories=s.data.map(l=>({title:l.name_th,value:l.id}))},E=async()=>{if(e.value.is_publish==null||e.value.is_publish.value==null||e.value.service_category_id==null||e.value.title_th==""||e.value.title_th==null||e.value.detail_th==""||e.value.detail_th==null){V("โปรดระบุข้อมูลให้ครบถ้วน","error");return}let s={text_success:"เพิ่มรายการเสร็จสิ้น",method:"post",url:m+"/serve/"},l={...e.value,serve_file:v.value.files!=null?v.value.files[0]:null,is_publish:e.value.is_publish.value,department_id:e.value.department_id==null?void 0:e.value.department_id.value,service_category_id:e.value.service_category_id==null?void 0:e.value.service_category_id.value,created_serve:g().format("YYYY-MM-DD")};var r=new FormData;for(var c in l)r.append(c,l[c]);await $fetch(s.url,{method:s.method,body:r}).then(d=>{if(d.msg=="success")V(s.text_success,"success"),x.push({path:"/admin/serve/"});else throw new Error("ERROR")}).catch(d=>d.data)};return U(()=>{w(),k()}),R({title:"เพิ่มงานบริการวิชาการ"}),(s,l)=>{const r=F,c=S,d=N("froala");return Y(),$(M,null,[t("section",O,[t("div",H,[t("div",L,[t("div",A,[t("div",G,[t("div",I,[J,K,t("span",null,[i(r,{href:"/admin/serve"},{default:u(()=>[j(" รายการงานบริการวิชาการ ")]),_:1})]),P,Q])])])])])]),t("section",W,[t("div",X,[t("div",Z,[tt,t("div",et,[t("div",lt,[t("div",at,[t("div",st,[ot,t("div",null,[i(c,null,{default:u(()=>[i(a(b),{label:"title",placeholder:"หน่วยงาน",options:a(_).departments,modelValue:a(e).department_id,"onUpdate:modelValue":l[0]||(l[0]=o=>a(e).department_id=o),class:"v-select-no-border",clearable:!0},null,8,["options","modelValue"])]),_:1})])]),t("div",it,[nt,t("div",null,[i(c,null,{default:u(()=>[i(a(b),{label:"title",placeholder:"ประเภทการบริการวิชาการ",options:a(_).service_categories,modelValue:a(e).service_category_id,"onUpdate:modelValue":l[1]||(l[1]=o=>a(e).service_category_id=o),class:"v-select-no-border",clearable:!0},null,8,["options","modelValue"])]),_:1})])]),t("div",ct,[rt,t("div",null,[t("input",{ref_key:"file",ref:v,class:"form-control",type:"file",id:"formFile"},null,512)])]),t("div",dt,[ut,t("div",null,[z(t("input",{type:"text",class:"form-control form-control-plaintext","onUpdate:modelValue":l[2]||(l[2]=o=>a(e).title_th=o)},null,512),[[D,a(e).title_th]])])]),t("div",_t,[ht,t("div",null,[i(c,null,{default:u(()=>[i(d,{tag:"textarea",config:a(n).detail_th,modelValue:a(e).detail_th,"onUpdate:modelValue":l[3]||(l[3]=o=>a(e).detail_th=o)},null,8,["config","modelValue"]),mt]),_:1})])]),t("div",vt,[pt,t("div",null,[i(c,null,{default:u(()=>[i(d,{tag:"textarea",config:a(n).rates_th,modelValue:a(e).rates_th,"onUpdate:modelValue":l[4]||(l[4]=o=>a(e).rates_th=o)},null,8,["config","modelValue"]),ft]),_:1})])]),t("div",bt,[gt,t("div",null,[i(c,null,{default:u(()=>[i(d,{tag:"textarea",config:a(n).location_th,modelValue:a(e).location_th,"onUpdate:modelValue":l[5]||(l[5]=o=>a(e).location_th=o)},null,8,["config","modelValue"]),Vt]),_:1})])]),t("div",yt,[xt,t("div",null,[i(c,null,{default:u(()=>[i(d,{tag:"textarea",config:a(n).contact_th,modelValue:a(e).contact_th,"onUpdate:modelValue":l[6]||(l[6]=o=>a(e).contact_th=o)},null,8,["config","modelValue"]),wt]),_:1})])]),t("div",kt,[Et,t("div",null,[i(c,null,{default:u(()=>[i(a(b),{label:"name_th",placeholder:"การเผยแพร่",options:a(_).publishes,id:"slt-is_publish",modelValue:a(e).is_publish,"onUpdate:modelValue":l[7]||(l[7]=o=>a(e).is_publish=o),class:"v-select-no-border",clearable:!0},null,8,["options","modelValue"])]),_:1})])]),t("div",{class:"col-md-12 mt-20"},[t("div",{class:"contact__btn-2 text-center"},[t("button",{class:"btn btn-primary",onClick:E}," บันทึก ")])])])])])])])])],64)}}};export{Dt as default};
