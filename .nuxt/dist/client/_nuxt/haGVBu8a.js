import{f as B,g as T,h as $,s as z,i as p,t as O,j,u as M,c as f,b as e,e as r,w as v,l,k as b,v as g,x as V,F as D,m as H,p as S,r as A,o as k,q as L,y as _,C as X}from"./OmrnE3d5.js";import{_ as G}from"./B-r68-ay.js";import{u as I}from"./D-HlV6Uy.js";import{u as x}from"./I6A_oj8C.js";import{b as J}from"./BKZYPkvF.js";import{f as E}from"./C0vxPmJo.js";const K={class:"breadcrumb__area include-bg pb-40 pt-30 grey-bg-4"},P={class:"container"},Q={class:"row"},W={class:"col-xxl-12"},Y={class:"breadcrumb__content p-relative z-index-1"},Z={class:"breadcrumb__list"},ee=e("span",null," จัดการข้อมูล ",-1),te=e("span",{class:"dvdr"},[e("i",{class:"fa-solid fa-circle-small"})],-1),le=e("span",{class:"dvdr"},[e("i",{class:"fa-solid fa-circle-small"})],-1),se=e("span",null," แก้ไขข้อมูล ",-1),ae={class:"portfolio__area pt-40 pb-40"},oe={class:"container"},ne={class:"row"},ie=e("div",{class:"col-12 mb-20"},[e("h4",null,"แบบฟอร์มแก้ไขข้อมูลหน่วยงาน")],-1),ue={class:"col-12"},re={class:""},ce={class:""},de={key:0,class:"form-group row mt-10"},_e=e("label",{for:"",class:"label label-required"},"ลำดับ : ",-1),me={class:"form-group row mt-10"},he=e("label",{for:"",class:"label label-required"},"ชื่อหน่วยงาน TH : ",-1),pe={class:"form-group row mt-10"},fe=e("label",{for:"",class:"label label-required"},"ชื่อหน่วยงาน EN : ",-1),ve={class:"form-group row mt-10"},be=e("label",{for:"",class:"label label-required"},"รูปภาพปก : ",-1),ge={class:"col-sm-10"},ke={class:"col-sm-2"},we=["href"],ye={class:"form-group row mt-10"},Ce=e("label",{for:"",class:"label label-required"},"รายละเอียดหน่วยงาน : ",-1),Ve=e("div",{id:"detail-th"},null,-1),xe={class:"form-group row mt-10"},Ee=e("label",{for:"",class:"label label-required"},"ข้อมูลติดต่อ : ",-1),qe=e("div",{id:"contact-th"},null,-1),Fe={key:1,class:"form-group row mt-10"},Ne=e("label",{for:"",class:"label label-required"},"สถานะ : ",-1),je={__name:"[id]",async setup(Re){let d,w;B.extend(T);const q=H(),{apiBase:y}=q.public,F=$(),N=z(),t=p({name_th:null,name_en:null,detail_th:"",contact_th:"",level:"",is_publish:{id:1,value:1,name_th:"publish",name_en:"publish",color:"success"}}),m=p(null),C=p({publishes:J.data().publishes,service_categories:[]});(Math.random()+1).toString(36).substring(7);let n={};const R=()=>{n.detail_th=E.data().froala_config(),n.detail_th.events={keyup:function(s){t.value.detail_th=this.html.get()},click:function(s){t.value.detail_th=this.html.get()},"commands.after":function(s,a,i){t.value.detail_th=this.html.get()},"paste.after":function(s){t.value.detail_th=this.html.get()},initialized:function(){this.html.insert(t.value.detail_th)}},n.contact_th=E.data().froala_config(),n.contact_th.events={keyup:function(s){t.value.contact_th=this.html.get()},click:function(s){t.value.contact_th=this.html.get()},"commands.after":function(s,a,i){t.value.contact_th=this.html.get()},"paste.after":function(s){t.value.contact_th=this.html.get()},initialized:function(){this.html.insert(t.value.contact_th)}}},{data:h}=([d,w]=O(()=>I(`${y}/department/${N.params.id}`,{server:!0},"$nXO7kTBzng")),d=await d,w(),d);t.value={...h.value.data},t.value.department_file_old=h.value.data.department_file,t.value.department_file=null,t.value.is_publish=C.value.publishes[Number(h.value.data.is_publish)];const U=async()=>{if(console.log(t.value),t.value.is_publish==null||t.value.is_publish.value==null||t.value.name_th==""||t.value.name_th==null||t.value.detail_th==""||t.value.detail_th==null){x("โปรดระบุข้อมูลให้ครบถ้วน","error");return}let s={text_success:"แก้ไขรายการเสร็จสิ้น",method:"put",url:y+"/department/"+t.value.id},a={...t.value,department_file:m.value.files!=null?m.value.files[0]:null,is_publish:t.value.is_publish.value};var i=new FormData;for(var c in a)i.append(c,a[c]);await $fetch(s.url,{method:s.method,body:i}).then(u=>{if(u.msg=="success")x(s.text_success,"success"),F.push({path:"/admin/department/"});else throw new Error("ERROR")}).catch(u=>u.data)};return j(()=>{R()}),M({title:"แก้ไขหน่วยงาน"}),(s,a)=>{const i=S,c=A("froala"),u=G;return k(),f(D,null,[e("section",K,[e("div",P,[e("div",Q,[e("div",W,[e("div",Y,[e("div",Z,[ee,te,e("span",null,[r(i,{href:"/admin/department"},{default:v(()=>[L(" รายการหน่วยงาน ")]),_:1})]),le,se])])])])])]),e("section",ae,[e("div",oe,[e("div",ne,[ie,e("div",ue,[e("div",re,[e("div",ce,[("useCookie"in s?s.useCookie:l(_))("user").value&&("useCookie"in s?s.useCookie:l(_))("user").value.group_id==1?(k(),f("div",de,[_e,e("div",null,[b(e("input",{type:"number",class:"form-control form-control-plaintext","onUpdate:modelValue":a[0]||(a[0]=o=>l(t).level=o)},null,512),[[g,l(t).level]])])])):V("",!0),e("div",me,[he,e("div",null,[b(e("input",{type:"text",class:"form-control form-control-plaintext","onUpdate:modelValue":a[1]||(a[1]=o=>l(t).name_th=o)},null,512),[[g,l(t).name_th]])])]),e("div",pe,[fe,e("div",null,[b(e("input",{type:"text",class:"form-control form-control-plaintext","onUpdate:modelValue":a[2]||(a[2]=o=>l(t).name_en=o)},null,512),[[g,l(t).name_en]])])]),e("div",ve,[be,e("div",ge,[e("input",{ref_key:"file",ref:m,class:"form-control",type:"file",id:"formFile"},null,512)]),e("div",ke,[e("a",{href:l(t).department_file_old,target:"_blank",class:"btn btn-primary",style:{width:"100%"}}," View Old File ",8,we)])]),e("div",ye,[Ce,e("div",null,[r(u,null,{default:v(()=>[r(c,{tag:"textarea",config:l(n).detail_th,modelValue:l(t).detail_th,"onUpdate:modelValue":a[3]||(a[3]=o=>l(t).detail_th=o)},null,8,["config","modelValue"]),Ve]),_:1})])]),e("div",xe,[Ee,e("div",null,[r(u,null,{default:v(()=>[r(c,{tag:"textarea",config:l(n).contact_th,modelValue:l(t).contact_th,"onUpdate:modelValue":a[4]||(a[4]=o=>l(t).contact_th=o)},null,8,["config","modelValue"]),qe]),_:1})])]),("useCookie"in s?s.useCookie:l(_))("user").value&&("useCookie"in s?s.useCookie:l(_))("user").value.group_id==1?(k(),f("div",Fe,[Ne,e("div",null,[r(l(X),{label:"name_th",placeholder:"การเผยแพร่",options:l(C).publishes,id:"slt-is_publish",modelValue:l(t).is_publish,"onUpdate:modelValue":a[5]||(a[5]=o=>l(t).is_publish=o),class:"v-select-no-border",clearable:!0},null,8,["options","modelValue"])])])):V("",!0),e("div",{class:"col-md-12 mt-20"},[e("div",{class:"contact__btn-2 text-center"},[e("button",{class:"btn btn-primary",onClick:U}," บันทึก ")])])])])])])])])],64)}}};export{je as default};
