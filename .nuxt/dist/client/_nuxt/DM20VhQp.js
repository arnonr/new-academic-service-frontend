import{f as $,g as D,i as n,z as E,A as N,j as T,u as V,c,b as t,k as I,v as R,l as a,q as S,F as f,d as z,x,e as y,B as j,a as A,m as F,y as m,o as i,D as u,E as H,w as L,p as M}from"./OmrnE3d5.js";import{u as O}from"./I6A_oj8C.js";import{b as U,S as Y}from"./BKZYPkvF.js";const q=A('<section class="breadcrumb__area include-bg pb-40 pt-30 grey-bg-4"><div class="container"><div class="row"><div class="col-xxl-12"><div class="breadcrumb__content p-relative z-index-1"><div class="breadcrumb__list"><span> จัดการข้อมูล </span><span class="dvdr"><i class="fa-solid fa-circle-small"></i></span><span> งานบริการวิชาการ </span></div></div></div></div></div></section>',1),G={class:"portfolio__area pt-40"},J={class:"container"},K={class:"mt-10 mb-30 pl-10 pt-15 pb-10 bg-grey"},Q=t("h4",{class:"section-bg-primary mb-20"},[t("i",{class:"fa-solid fa-search"}),t("span",{class:"ml-10"},"ค้นหา")],-1),W={class:"col-12 col-lg-12 mb-20"},X=t("div",null,[t("button",{class:"btn btn-success"},"ค้นหา")],-1),Z={class:"portfolio__area pb-20"},tt={class:"container"},et={class:"mt-10 mb-30 pl-10 pt-15 pb-10 bg-grey"},st=t("h4",{class:"section-bg-primary mb-20"},[t("i",{class:"fa-regular fa-list"}),t("span",{class:"ml-10"},"รายการงานบริการวิชาการ")],-1),at={class:"mb-20"},ot=t("i",{class:"fa-regular fa-plus"},null,-1),nt={class:"row gx-2 grid"},lt={class:"col-12"},ct={class:"table-responsive"},it={class:"table table-bordered table-striped table-admin"},rt=t("thead",null,[t("tr",null,[t("th",{class:"text-center"},"ชื่อ (TH)"),t("th",{class:"text-center"},"หน่วยงาน"),t("th",{class:"text-center"},"ประเภท"),t("th",{class:"text-center"},"สถานะ"),t("th",{class:"text-center"},"จัดการ")])],-1),dt={key:0},ut={cla:"",ss:"text-center"},_t={class:"text-center"},pt={class:"text-center"},ht={class:"text-center"},mt={class:"text-center"},bt=t("i",{class:"fa-regular fa-edit"},null,-1),vt=["onClick"],gt=t("i",{class:"fa-regular fa-trash"},null,-1),ft=[gt],xt={class:"col-xxl-12"},yt={class:"tp-pagination mt-30"},$t={__name:"index",setup(wt){$.extend(D);const w=F(),{apiBase:b}=w.public,_=n([]),C=n(20),l=n(1),r=n(1),v=n(0),d=n({}),g=n({perPage:[{title:"20",value:20},{title:"40",value:40},{title:"60",value:60}],publishes:U.data().publishes}),p=async()=>{let o={...d.value,perPage:C.value,currentPage:l.value};m("user").value&&m("user").value.group_id==2&&(o.department_id=m("user").value.department_id);let e=await $fetch(`${b}/serve`,{params:o}).catch(h=>h.data);_.value=e.data,r.value=e.totalPage,v.value=e.totalData};E([l,d],()=>{p()},{deep:!0}),N(()=>{l.value>r.value&&(l.value=r.value)}),T(()=>{p()});const P=async o=>{Y.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Cancle it!"}).then(e=>{e.isConfirmed&&k(o)})},k=async o=>{await $fetch(`${b}/serve/${o}`,{method:"delete"}).then(e=>{if(e.msg=="success")O("ลบรายการเสร็จสิ้น","success"),p(),window.scrollTo({top:0,behavior:"smooth"});else throw new Error("ERROR")}).catch(e=>e.data)};return V({title:"รายการการให้บริการ"}),(o,e)=>{const h=M;return i(),c(f,null,[q,t("section",G,[t("div",J,[t("div",K,[Q,t("div",W,[I(t("input",{class:"form-control","onUpdate:modelValue":e[0]||(e[0]=s=>a(d).title_th=s),name:"title",type:"text",placeholder:"ชื่อหัวข้องานบริการวิชาการ"},null,512),[[R,a(d).title_th]])]),X])])]),t("section",Z,[t("div",tt,[t("div",et,[st,t("div",at,[t("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=()=>{o.$router.push({path:"/admin/serve/add"})})},[ot,S(" เพิ่มข้อมูล ")])]),t("div",nt,[t("div",lt,[t("div",ct,[t("table",it,[rt,a(_).length!=0?(i(),c("tbody",dt,[(i(!0),c(f,null,z(a(_),(s,B)=>(i(),c("tr",{key:B},[t("td",ut,u(s.title_th),1),t("td",_t,u(s.department.name_th),1),t("td",pt,u(s.service_category.name_th),1),t("td",ht,[s.is_publish!=null?(i(),c("span",{key:0,class:H("badge rounded-pill bg-"+a(g).publishes[s.is_publish].color)},u(a(g).publishes[s.is_publish].name_th),3)):x("",!0)]),t("td",mt,[y(h,{to:{name:"admin-serve-edit-id",params:{id:s.id}},class:"btn btn-warning text-uppercase ml-5"},{default:L(()=>[bt]),_:2},1032,["to"]),t("button",{class:"btn btn-danger ml-5",onClick:Ct=>P(s.id)},ft,8,vt)])]))),128))])):x("",!0)])])])]),t("div",xt,[t("div",yt,[y(j,{totalPage:a(r),currentPage:a(l),totalItems:a(v),"onUpdate:currentPage":e[2]||(e[2]=s=>l.value=s)},null,8,["totalPage","currentPage","totalItems"])])])])])])],64)}}};export{$t as default};
